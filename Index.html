import React, { useState, useEffect, useCallback } from 'react';
import { 
  Calendar, Thermometer, CloudRain, Sun, Wind, AlertTriangle, TrendingUp, 
  MapPin, Clock, Bell, Droplets, Eye, Activity, Settings, Camera, Bug, Leaf, 
  Calculator, Map, BarChart3, Timer, Zap, CheckCircle, Users, MessageCircle, 
  Star, Award, Phone, Volume2, Wifi, Target, Menu, X, Plus, Send, ThumbsUp, 
  Share, Save, RefreshCw, Download, Home, ChevronRight, Database, Brain,
  User, Mail, HelpCircle, Verified, Shield
} from 'lucide-react';

const CROP_DATABASE = {
  rice: {
    name: '벼',
    baseTemp: 10,
    gddStages: [
      { stage: '파종', gdd: 0, tasks: ['종자 준비', '논 정리'] },
      { stage: '발아', gdd: 120, tasks: ['물 관리', '온도 조절'] },
      { stage: '분얼', gdd: 400, tasks: ['제초', '추비시용'] },
      { stage: '수잉', gdd: 800, tasks: ['물 깊이 조절', '병해충 방제'] },
      { stage: '출수', gdd: 1200, tasks: ['수분 관리', '조류 방제'] },
      { stage: '성숙', gdd: 1600, tasks: ['수확 준비', '건조 준비'] }
    ]
  },
  cabbage: {
    name: '배추',
    baseTemp: 5,
    gddStages: [
      { stage: '파종', gdd: 0, tasks: ['종자 소독', '상토 준비'] },
      { stage: '발아', gdd: 80, tasks: ['온도 관리', '습도 조절'] },
      { stage: '본엽', gdd: 200, tasks: ['간식', '웃거름'] },
      { stage: '결구시작', gdd: 500, tasks: ['충분한 관수', '토양 관리'] },
      { stage: '결구완성', gdd: 800, tasks: ['수확 준비', '저장 준비'] }
    ]
  }
};

const SmartFarmApp = () => {
  const [currentScreen, setCurrentScreen] = useState('home');
  const [voiceEnabled, setVoiceEnabled] = useState(false);
  const [userProfile, setUserProfile] = useState({});
  const [farmData, setFarmData] = useState({});
  const [crops, setCrops] = useState([]);
  const [sensors, setSensors] = useState({});
  const [alerts, setAlerts] = useState([]);
  const [livingSeasons, setLivingSeasons] = useState({});
  const [activeChatRoom, setActiveChatRoom] = useState(null);
  const [newMessage, setNewMessage] = useState('');
  const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth());

  const speakText = useCallback((text) => {
    if (voiceEnabled && 'speechSynthesis' in window) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'ko-KR';
      utterance.rate = 0.9;
      speechSynthesis.speak(utterance);
    }
  }, [voiceEnabled]);

  const updateSensorData = useCallback(() => {
    setSensors({
      soilMoisture: 45 + Math.random() * 20,
      soilTemp: 24 + Math.random() * 4,
      airTemp: 32 + Math.random() * 6,
      humidity: 70 + Math.random() * 15,
      ph: 6.2 + Math.random() * 0.6,
      lightIntensity: 45000 + Math.random() * 10000
    });
  }, []);

  useEffect(() => {
    setUserProfile({ name: '김농부', location: '공주시 유구읍', level: 'Gold', points: 3450 });
    setFarmData({ totalArea: 5000 });
    setCrops([
      { id: 1, name: '벼 (추청)', type: 'rice', variety: '추청', area: 3000, stage: '성숙기', nextStage: '수확', progress: 78, gddAccumulated: 1247, healthStatus: 'good', tasks: ['수확 준비', '건조 준비'], daysToNext: 5 },
      { id: 2, name: '배추 (불암3호)', type: 'cabbage', variety: '불암3호', area: 1500, stage: '정식 대기', nextStage: '본엽', progress: 0, gddAccumulated: 0, healthStatus: 'good', tasks: ['종자 소독', '상토 준비'], daysToNext: 15 }
    ]);
    setAlerts([
      { title: '극한폭염 경보', severity: 'critical', message: '3일 연속 35°C 이상, 작물 고사 위험', actions: ['긴급 관수 시스템 가동', '차광망 100% 설치'] }
    ]);
    setLivingSeasons({
      traditional: { name: '처서', date: '8월 23일', expectedTemp: 28 },
      living: { name: '실질처서', date: '8월 26일', actualTemp: 31.2, adjustment: '+3일' }
    });
    updateSensorData();
    const interval = setInterval(updateSensorData, 5000);
    return () => clearInterval(interval);
  }, [updateSensorData]);

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="bg-gradient-to-r from-green-600 to-emerald-600 text-white p-4 sticky top-0 z-50">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className="text-2xl">🌾</div>
            <div>
              <h1 className="text-xl font-bold">스마트 생활절기</h1>
              <p className="text-xs opacity-90">{userProfile.name || '농부'} • {userProfile.location || '공주시'}</p>
            </div>
          </div>
          <div className="flex items-center gap-2">
            <Wifi className="w-5 h-5" />
            <button onClick={() => setVoiceEnabled(!voiceEnabled)} className={`p-2 rounded ${voiceEnabled ? 'bg-green-500' : 'bg-green-700'}`}>
              <Volume2 className="w-5 h-5" />
            </button>
          </div>
        </div>
      </div>

      <div className="pb-20">
        {currentScreen === 'home' && (
          <div className="p-4 space-y-6 pb-24">
            {alerts.length > 0 && (
              <div className="bg-gradient-to-r from-red-50 to-orange-50 border border-red-200 rounded-xl p-4 shadow-lg">
                <div className="flex items-center gap-2 text-red-800 font-bold mb-3">
                  <AlertTriangle className="w-6 h-6 animate-pulse" />
                  긴급 농업 알림 ({alerts.length}건)
                </div>
                {alerts.map((alert, idx) => (
                  <div key={idx} className="mb-3">
                    <div className="flex items-center justify-between mb-2">
                      <span className="px-3 py-1 rounded-full text-sm font-semibold bg-red-500 text-white">{alert.title}</span>
                      <button onClick={() => speakText(alert.message)} className="text-red-600"><Volume2 className="w-4 h-4" /></button>
                    </div>
                    <div className="text-red-700 text-sm mb-2">{alert.message}</div>
                    {alert.actions?.map((action, i) => (
                      <div key={i} className="flex items-center gap-2 text-xs text-red-600">
                        <CheckCircle className="w-3 h-3 text-green-600" /><span>• {action}</span>
                      </div>
                    ))}
                  </div>
                ))}
              </div>
            )}
            <div className="bg-gradient-to-br from-green-50 to-blue-50 rounded-xl shadow-lg p-5">
              <h3 className="font-bold text-xl mb-4 flex items-center gap-2">
                <Calendar className="w-6 h-6 text-green-600" />오늘의 생활절기
              </h3>
              <div className="grid grid-cols-2 gap-4 mb-4">
                <div className="text-center p-4 bg-green-100 rounded-lg">
                  <div className="text-sm text-gray-600 mb-1">전통절기</div>
                  <div className="font-bold text-xl text-green-700">{livingSeasons?.traditional?.name}</div>
                  <div className="text-xs text-gray-500">{livingSeasons?.traditional?.date}</div>
                  <div className="text-xs text-green-600 mt-1">예상기온: {livingSeasons?.traditional?.expectedTemp}°C</div>
                </div>
                <div className="text-center p-4 bg-blue-100 rounded-lg">
                  <div className="text-sm text-gray-600 mb-1">생활절기</div>
                  <div className="font-bold text-xl text-blue-700">{livingSeasons?.living?.name}</div>
                  <div className="text-xs text-gray-500">{livingSeasons?.living?.date}</div>
                  <div className="text-xs text-blue-600 mt-1">실제기온: {livingSeasons?.living?.actualTemp}°C</div>
                </div>
              </div>
              <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                <div className="font-semibold text-yellow-800 mb-1">절기 분석</div>
                <div className="text-sm text-yellow-700">올해는 평년보다 {livingSeasons?.living?.adjustment} 늦은 절기로, 기후변화의 영향으로 생육기간이 연장되고 있습니다.</div>
              </div>
            </div>
            <div className="bg-white rounded-xl shadow-lg p-5">
              <h3 className="font-bold text-xl mb-4 flex items-center gap-2">
                <TrendingUp className="w-6 h-6 text-orange-600" />생육도일(GDD) 실시간 현황
              </h3>
              {crops.map((crop) => (
                <div key={crop.id} className="mb-6 last:mb-0 p-4 border border-gray-200 rounded-lg">
                  <div className="flex justify-between items-center mb-3">
                    <div className="flex items-center gap-3">
                      <div className="text-2xl">{crop.type === 'rice' ? '🌾' : '🥬'}</div>
                      <div>
                        <div className="font-bold text-lg">{crop.name}</div>
                        <div className="text-sm text-gray-600">{crop.variety} • {crop.area}평</div>
                      </div>
                    </div>
                    <div className={`px-3 py-1 rounded-full text-sm font-semibold ${crop.healthStatus === 'good' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'}`}>
                      {crop.healthStatus === 'good' ? '양호' : '주의'}
                    </div>
                  </div>
                  <div className="mb-3">
                    <div className="flex justify-between items-center mb-2">
                      <span className="text-sm font-medium">현재: {crop.stage}</span>
                      <span className="text-sm text-gray-500">다음: {crop.nextStage} (D-{crop.daysToNext})</span>
                    </div>
                    <div className="bg-gray-200 rounded-full h-4 mb-2">
                      <div className="bg-gradient-to-r from-green-400 to-green-600 h-4 rounded-full" style={{ width: `${crop.progress}%` }}></div>
                    </div>
                    <div className="flex justify-between text-xs text-gray-600">
                      <span>누적 GDD: {crop.gddAccumulated}°C</span>
                      <span>{crop.progress}% 완료</span>
                    </div>
                  </div>
                  <div className="p-3 bg-blue-50 rounded-lg">
                    <div className="font-semibold text-blue-800 mb-2">{crop.stage} 단계 권장작업</div>
                    <div className="flex flex-wrap gap-2">
                      {crop.tasks.map((task, i) => (
                        <span key={i} className="px-2 py-1 bg-blue-200 text-blue-700 rounded text-xs">{task}</span>
                      ))}
                    </div>
                  </div>
                </div>
              ))}
            </div>
            <div className="bg-white rounded-xl shadow-lg p-5">
              <h3 className="font-bold text-xl mb-4 flex items-center gap-2">
                <Zap className="w-6 h-6 text-yellow-600" />AI 스마트팜 자동제어
              </h3>
              <div className="grid grid-cols-2 gap-3">
                <div className="p-3 bg-blue-50 rounded-lg">
                  <div className="flex items-center gap-2 mb-2">
                    <Database className="w-5 h-5 text-blue-600" />
                    <span className="font-medium text-blue-800">토양 센서</span>
                  </div>
                  <div className="space-y-1 text-sm">
                    <div className="flex justify-between"><span>습도:</span><span className="font-bold text-blue-600">{sensors.soilMoisture?.toFixed(0)}%</span></div>
                    <div className="flex justify-between"><span>온도:</span><span className="font-bold text-blue-600">{sensors.soilTemp?.toFixed(1)}°C</span></div>
                    <div className="flex justify-between"><span>pH:</span><span className="font-bold text-blue-600">{sensors.ph?.toFixed(1)}</span></div>
                  </div>
                </div>
                <div className="p-3 bg-green-50 rounded-lg">
                  <div className="flex items-center gap-2 mb-2">
                    <Activity className="w-5 h-5 text-green-600" />
                    <span className="font-medium text-green-800">환경 센서</span>
                  </div>
                  <div className="space-y-1 text-sm">
                    <div className="flex justify-between"><span>기온:</span><span className="font-bold text-green-600">{sensors.airTemp?.toFixed(1)}°C</span></div>
                    <div className="flex justify-between"><span>습도:</span><span className="font-bold text-green-600">{sensors.humidity?.toFixed(0)}%</span></div>
                    <div className="flex justify-between"><span>조도:</span><span className="font-bold text-green-600">{(sensors.lightIntensity/1000)?.toFixed(0)}klx</span></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}

        {currentScreen === 'calendar' && (
// ===== Part 1 끝, Part 2에서 계속 =====
          <div className="p-4 space-y-6 pb-24">
            <div className="bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-xl p-5">
              <h2 className="text-2xl font-bold mb-4">2024년 생활절기 달력</h2>
              <div className="flex gap-2 overflow-x-auto">
                {Array.from({length: 12}, (_, i) => i).map(month => (
                  <button key={month} onClick={() => setSelectedMonth(month)}
                    className={`px-3 py-2 rounded-lg text-sm whitespace-nowrap ${selectedMonth === month ? 'bg-white text-green-600 font-bold' : 'bg-white bg-opacity-20'}`}>
                    {month + 1}월
                  </button>
                ))}
              </div>
            </div>
            <div className="bg-white rounded-xl shadow-lg p-5">
              <h3 className="font-bold text-lg mb-4">{selectedMonth + 1}월 농업 달력</h3>
              <div className="mb-4 p-3 bg-green-50 rounded-lg">
                <div className="font-semibold text-green-800 mb-1">전통절기</div>
                <div className="text-sm text-green-700">
                  {selectedMonth === 7 ? '입추(8/7), 처서(8/23)' : selectedMonth === 8 ? '백로(9/7), 추분(9/22)' : '해당 월 절기'}
                </div>
              </div>
              <div className="mb-4 p-3 bg-blue-50 rounded-lg">
                <div className="font-semibold text-blue-800 mb-1">생활절기</div>
                <div className="text-sm text-blue-700">
                  {selectedMonth === 7 ? '실질입추(8/10), 실질처서(8/26)' : selectedMonth === 8 ? '실질백로(9/10), 실질추분(9/25)' : '해당 월 절기'}
                </div>
              </div>
              <div className="p-3 bg-yellow-50 rounded-lg">
                <div className="font-semibold text-yellow-800 mb-2">이달의 농작업</div>
                <div className="space-y-1 text-sm text-yellow-700">
                  <div>벼: {selectedMonth === 7 ? '수잉기 관리' : selectedMonth === 8 ? '출수기 관리' : selectedMonth === 9 ? '성숙기 관리' : '해당 작업 없음'}</div>
                  <div>배추: {selectedMonth === 8 ? '가을배추 파종' : selectedMonth === 9 ? '정식' : selectedMonth === 10 ? '결구기' : '해당 작업 없음'}</div>
                </div>
              </div>
            </div>
          </div>
        )}

        {currentScreen === 'management' && (
          <div className="p-4 space-y-6 pb-24">
            <div className="bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl p-5">
              <h2 className="text-2xl font-bold mb-2">농장 관리</h2>
              <p className="opacity-90">실시간 농장 데이터 및 작물 관리</p>
            </div>
            <div className="bg-white rounded-xl shadow-lg p-5">
              <h3 className="font-bold text-xl mb-4 flex items-center gap-2">
                <Map className="w-6 h-6 text-green-600" />농장 지도
              </h3>
              <div className="bg-gradient-to-br from-green-100 to-emerald-100 rounded-lg p-8 text-center">
                <div className="text-4xl mb-2">🗺️</div>
                <div className="font-semibold text-gray-700">농장 위치: {userProfile.location}</div>
                <div className="text-sm text-gray-600 mt-2">총 면적: {farmData.totalArea}평</div>
              </div>
            </div>
            <div className="bg-white rounded-xl shadow-lg p-5">
              <h3 className="font-bold text-xl mb-4 flex items-center gap-2">
                <BarChart3 className="w-6 h-6 text-blue-600" />센서 데이터 차트
              </h3>
              <div className="grid grid-cols-2 gap-4">
                <div className="p-4 border border-gray-200 rounded-lg">
                  <div className="text-sm text-gray-600 mb-2">토양 습도</div>
                  <div className="text-2xl font-bold text-blue-600">{sensors.soilMoisture?.toFixed(1)}%</div>
                  <div className="w-full bg-gray-200 rounded-full h-2 mt-2">
                    <div className="bg-blue-500 h-2 rounded-full" style={{ width: `${sensors.soilMoisture}%` }}></div>
                  </div>
                </div>
                <div className="p-4 border border-gray-200 rounded-lg">
                  <div className="text-sm text-gray-600 mb-2">기온</div>
                  <div className="text-2xl font-bold text-red-600">{sensors.airTemp?.toFixed(1)}°C</div>
                  <div className="w-full bg-gray-200 rounded-full h-2 mt-2">
                    <div className="bg-red-500 h-2 rounded-full" style={{ width: `${(sensors.airTemp/40)*100}%` }}></div>
                  </div>
                </div>
                <div className="p-4 border border-gray-200 rounded-lg">
                  <div className="text-sm text-gray-600 mb-2">대기 습도</div>
                  <div className="text-2xl font-bold text-green-600">{sensors.humidity?.toFixed(0)}%</div>
                  <div className="w-full bg-gray-200 rounded-full h-2 mt-2">
                    <div className="bg-green-500 h-2 rounded-full" style={{ width: `${sensors.humidity}%` }}></div>
                  </div>
                </div>
                <div className="p-4 border border-gray-200 rounded-lg">
                  <div className="text-sm text-gray-600 mb-2">토양 pH</div>
                  <div className="text-2xl font-bold text-purple-600">{sensors.ph?.toFixed(2)}</div>
                  <div className="w-full bg-gray-200 rounded-full h-2 mt-2">
                    <div className="bg-purple-500 h-2 rounded-full" style={{ width: `${((sensors.ph-5)/3)*100}%` }}></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}

        {currentScreen === 'community' && (
// ===== Part 2 끝, Part 3에서 계속 =====
<div className="p-4 space-y-6 pb-24">
            <div className="bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl p-5">
              <h2 className="text-2xl font-bold mb-2">농업 커뮤니티</h2>
              <p className="opacity-90">이웃 농부들과 실시간 정보 공유</p>
            </div>
            {!activeChatRoom ? (
              <>
                <div className="bg-white rounded-xl shadow-lg p-5">
                  <h3 className="font-bold text-lg mb-4 flex items-center gap-2">
                    <MessageSquare className="w-6 h-6 text-indigo-600" />실시간 채팅방
                  </h3>
                  <div className="space-y-3">
                    {[
                      { id: 1, name: '공주시 벼농사 모임', members: 45, active: 12, lastMessage: '방제 결과 공유합니다', urgent: false },
                      { id: 2, name: '폭염 대응 긴급방', members: 128, active: 34, lastMessage: '관수 시스템 고장났어요', urgent: true }
                    ].map(room => (
                      <div key={room.id} className={`p-4 border rounded-lg cursor-pointer hover:border-indigo-300 ${room.urgent ? 'border-red-300 bg-red-50' : 'border-gray-200'}`}
                        onClick={() => setActiveChatRoom(room)}>
                        <div className="flex items-center justify-between mb-2">
                          <div className="flex items-center gap-2">
                            <div className={`font-semibold ${room.urgent ? 'text-red-800' : 'text-indigo-800'}`}>{room.name}</div>
                            {room.urgent && <span className="px-2 py-1 bg-red-500 text-white text-xs rounded-full animate-pulse">긴급</span>}
                          </div>
                          <div className="flex items-center gap-1 text-xs text-green-600">
                            <div className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>{room.active}명
                          </div>
                        </div>
                        <div className="text-sm text-gray-600">{room.lastMessage}</div>
                        <div className="text-xs text-gray-500 mt-1">총 {room.members}명 참여</div>
                      </div>
                    ))}
                  </div>
                </div>
                <div className="bg-white rounded-xl shadow-lg p-5">
                  <h3 className="font-bold text-lg mb-4 flex items-center gap-2">
                    <Users className="w-6 h-6 text-green-600" />지역 소식
                  </h3>
                  <div className="space-y-3">
                    {[
                      { id: 1, author: '김농부', location: '1.2km', content: '우리 동네도 벼멸구 발견! 방제 같이 하실분?', likes: 5, comments: 2, urgent: true },
                      { id: 2, author: '이농사', location: '0.8km', content: '배추 정식했는데 생육이 좋네요. 사진 공유합니다.', likes: 8, comments: 4, urgent: false }
                    ].map(post => (
                      <div key={post.id} className={`p-4 border rounded-lg ${post.urgent ? 'border-red-200 bg-red-50' : 'border-gray-200'}`}>
                        <div className="flex items-start justify-between mb-2">
                          <div className="flex items-center gap-2">
                            <div className="w-10 h-10 bg-gradient-to-r from-green-400 to-blue-400 rounded-full flex items-center justify-center text-white font-bold">
                              {post.author[0]}
                            </div>
                            <div>
                              <div className="font-semibold">{post.author}</div>
                              <div className="text-xs text-gray-500">{post.location}</div>
                            </div>
                          </div>
                          {post.urgent && <AlertTriangle className="w-5 h-5 text-red-600" />}
                        </div>
                        <div className="text-sm mb-2">{post.content}</div>
                        <div className="flex items-center gap-4 text-xs text-gray-600">
                          <button className="flex items-center gap-1 hover:text-red-500">
                            <ThumbsUp className="w-4 h-4" />{post.likes}
                          </button>
                          <button className="flex items-center gap-1 hover:text-blue-500">
                            <MessageCircle className="w-4 h-4" />{post.comments}
                          </button>
                          <button className="flex items-center gap-1 hover:text-green-500">
                            <Share className="w-4 h-4" />공유
                          </button>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </>
            ) : (
              <div className="bg-white rounded-xl shadow-lg p-5">
                <div className="flex items-center justify-between mb-4">
                  <div>
                    <div className="font-bold text-indigo-800">{activeChatRoom.name}</div>
                    <div className="text-sm text-gray-600">{activeChatRoom.active}명이 대화 중</div>
                  </div>
                  <button onClick={() => setActiveChatRoom(null)} className="p-2 hover:bg-gray-100 rounded">
                    <X className="w-5 h-5" />
                  </button>
                </div>
                <div className="space-y-3 mb-4 h-64 overflow-y-auto bg-gray-50 rounded p-3">
                  <div className="flex justify-start">
                    <div className="bg-white p-3 rounded-lg max-w-xs shadow-sm">
                      <div className="text-xs text-gray-500 mb-1">김농부</div>
                      <div className="text-sm">벼멸구 방제 완료했습니다. 효과 좋네요!</div>
                    </div>
                  </div>
                  <div className="flex justify-end">
                    <div className="bg-indigo-600 text-white p-3 rounded-lg max-w-xs">
                      <div className="text-sm">우리 동네는 아직 괜찮은 것 같은데요</div>
                    </div>
                  </div>
                </div>
                <div className="flex gap-2">
                  <button className="p-2 border border-gray-300 rounded hover:bg-gray-50">
                    <Camera className="w-5 h-5 text-gray-600" />
                  </button>
                  <input type="text" value={newMessage} onChange={(e) => setNewMessage(e.target.value)}
                    placeholder="메시지를 입력하세요..." className="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    onKeyPress={(e) => e.key === 'Enter' && setNewMessage('')} />
                  <button onClick={() => setNewMessage('')} className="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                    <Send className="w-5 h-5" />
                  </button>
                </div>
              </div>
            )}
          </div>
        )}

        {currentScreen === 'settings' && (
// ===== Part 3 끝, Part 4에서 계속 =====
<div className="p-4 space-y-6 pb-24">
            <div className="bg-gradient-to-r from-gray-700 to-gray-900 text-white rounded-xl p-5">
              <h2 className="text-2xl font-bold mb-2">설정</h2>
              <p className="opacity-90">앱 설정 및 계정 관리</p>
            </div>
            <div className="bg-white rounded-xl shadow-lg p-5">
              <h3 className="font-bold text-lg mb-4">프로필</h3>
              <div className="flex items-center gap-4 mb-6">
                <div className="w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center text-white text-2xl font-bold">
                  {userProfile.name?.charAt(0) || 'K'}
                </div>
                <div>
                  <div className="font-bold text-xl">{userProfile.name}</div>
                  <div className="text-gray-600">{userProfile.location}</div>
                  <div className="flex items-center gap-2 mt-1">
                    <Star className="w-4 h-4 text-yellow-500" />
                    <span className="text-sm font-medium">{userProfile.level} 등급</span>
                    <span className="text-sm text-gray-500">({userProfile.points}P)</span>
                  </div>
                </div>
              </div>
            </div>
            <div className="bg-white rounded-xl shadow-lg p-5">
              <h3 className="font-bold text-lg mb-4">알림 설정</h3>
              <div className="space-y-4">
                {[
                  { key: 'emergency', label: '긴급 알림', desc: '폭염, 가뭄 등 긴급 상황', enabled: true },
                  { key: 'weather', label: '기상 알림', desc: '일기예보 및 기상 변화', enabled: true },
                  { key: 'schedule', label: '작업 알림', desc: '농작업 일정 및 권장사항', enabled: true },
                  { key: 'sensor', label: '센서 알림', desc: '센서 이상 및 임계값 도달', enabled: true }
                ].map(notification => (
                  <div key={notification.key} className="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                    <div>
                      <div className="font-medium">{notification.label}</div>
                      <div className="text-sm text-gray-600">{notification.desc}</div>
                    </div>
                    <button className={`w-12 h-6 rounded-full ${notification.enabled ? 'bg-green-500' : 'bg-gray-300'}`}>
                      <div className={`w-5 h-5 bg-white rounded-full transition-transform ${notification.enabled ? 'translate-x-6' : 'translate-x-0.5'}`}></div>
                    </button>
                  </div>
                ))}
              </div>
            </div>
            <div className="bg-white rounded-xl shadow-lg p-5">
              <h3 className="font-bold text-lg mb-4">시스템</h3>
              <div className="space-y-3">
                <button className="w-full flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                  <div className="flex items-center gap-3">
                    <Database className="w-5 h-5 text-gray-600" />
                    <span>데이터 백업</span>
                  </div>
                  <ChevronRight className="w-5 h-5 text-gray-400" />
                </button>
                <button className="w-full flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                  <div className="flex items-center gap-3">
                    <HelpCircle className="w-5 h-5 text-gray-600" />
                    <span>도움말</span>
                  </div>
                  <ChevronRight className="w-5 h-5 text-gray-400" />
                </button>
                <button className="w-full flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                  <div className="flex items-center gap-3">
                    <Phone className="w-5 h-5 text-gray-600" />
                    <span>고객센터</span>
                  </div>
                  <ChevronRight className="w-5 h-5 text-gray-400" />
                </button>
              </div>
            </div>
          </div>
        )}
      </div>

      <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2">
        <div className="flex justify-around">
// ===== Part 4 끝, Part 5에서 계속 =====
<button onClick={() => setCurrentScreen('home')} className={`flex flex-col items-center p-2 ${currentScreen === 'home' ? 'text-green-600' : 'text-gray-400'}`}>
            <Home className="w-6 h-6" />
            <span className="text-xs mt-1">홈</span>
          </button>
          <button onClick={() => setCurrentScreen('calendar')} className={`flex flex-col items-center p-2 ${currentScreen === 'calendar' ? 'text-green-600' : 'text-gray-400'}`}>
            <Calendar className="w-6 h-6" />
            <span className="text-xs mt-1">절기달력</span>
          </button>
          <button onClick={() => setCurrentScreen('management')} className={`flex flex-col items-center p-2 ${currentScreen === 'management' ? 'text-green-600' : 'text-gray-400'}`}>
            <BarChart3 className="w-6 h-6" />
            <span className="text-xs mt-1">관리</span>
          </button>
          <button onClick={() => setCurrentScreen('community')} className={`flex flex-col items-center p-2 ${currentScreen === 'community' ? 'text-green-600' : 'text-gray-400'}`}>
            <Users className="w-6 h-6" />
            <span className="text-xs mt-1">커뮤니티</span>
          </button>
          <button onClick={() => setCurrentScreen('settings')} className={`flex flex-col items-center p-2 ${currentScreen === 'settings' ? 'text-green-600' : 'text-gray-400'}`}>
            <Settings className="w-6 h-6" />
            <span className="text-xs mt-1">설정</span>
          </button>
        </div>
      </div>
    </div>
  );
};

export default SmartFarmApp;
